---
sidebar: sidebar 
permalink: task_restore_backups.html 
keywords: restoring, restore, restore volumes, restore files, Cloud Backup, cloud backup service, single file restore 
summary: バックアップは、特定の時点のデータをリストアできるように、クラウドアカウントのオブジェクトストアに格納されます。保存したバックアップファイルからボリューム全体をリストアすることも、いくつかのファイルだけをリストアする必要がある場合は、保存したバックアップファイルから個々のファイルをリストアすることもできます。 
---
= バックアップファイルからのデータのリストア
:hardbreaks:
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./media/


[role="lead"]
バックアップは、特定の時点のデータをリストアできるように、クラウドアカウントのオブジェクトストアに格納されます。保存したバックアップファイルからボリューム全体をリストアすることも、いくつかのファイルだけをリストアする必要がある場合は、保存したバックアップファイルから個々のファイルをリストアすることもできます。

ボリューム全体を同じ作業環境、同じクラウドアカウントを使用している別の作業環境、またはオンプレミスの ONTAP システムにリストアできます。を参照してください <<Restoring a volume from a backup file,バックアップからのボリュームのリストア>>。

同じ作業環境内のボリューム、同じクラウドアカウントを使用している別の作業環境内のボリューム、またはオンプレミスの ONTAP システム上のボリュームにファイルをリストアできます。を参照してください <<Restoring files from a backup,バックアップからのファイルのリストア>>。



== サポートされている作業環境とオブジェクトストレージプロバイダ

ボリュームまたは個々のファイルをバックアップファイルから次の作業環境にリストアできます。

[cols="25,40,40"]
|===
| バックアップファイルの場所 2+| デスティネーションの作業環境 


|  | * ボリュームの復元 * | * ファイルの復元 * 


| Amazon S3 | オンプレミスの AWS ONTAP システムに Cloud Volumes ONTAP が導入されている | オンプレミスの AWS ONTAP システムに Cloud Volumes ONTAP が導入されている 


| Azure Blob の略 | オンプレミスの Azure ONTAP システムに Cloud Volumes ONTAP を導入 | オンプレミスの Azure ONTAP システムに Cloud Volumes ONTAP を導入 


| Google クラウドストレージ | Google オンプレミス ONTAP システムの Cloud Volumes ONTAP |  


| NetApp StorageGRID | オンプレミスの ONTAP システム |  
|===


== リストアダッシュボード

リストアダッシュボードにアクセスするには、 Cloud Manager の上部にある * バックアップとリストア * タブをクリックするか、をクリックします image:screenshot_gallery_options.gif["[ 詳細 ] ボタン"] > * サービス・パネルからバックアップ / リストア・サービスのリストア・ダッシュボード * を表示します。


NOTE: 少なくとも 1 つの作業環境に対して Cloud Backup Service がアクティブ化されている必要があります。

image:screenshot_restore_dashboard.png["リストアダッシュボードには、ボリュームとファイルをリストアするためのボタンと、リストアされたすべてのデータの表示方法が表示されます。"]

リストアダッシュボードには、ボリュームとファイルをリストアするためのボタンがあります。[ ボリュームの復元 ] または [ ファイルの復元 ] ボタンをクリックすると、ウィザードが起動され、データを復元する手順が示されます。

ダッシュボードには、以前のリストア操作の履歴が必要な場合に備えて、リストアしたすべてのボリュームとすべてのファイルのリストも表示されます。リストアされた各ボリュームまたはファイルの行を展開すると、ボリュームまたはファイルのソースとデスティネーションの場所に関する詳細を確認できます。

サービスパネルの作業環境からボリュームまたはファイルのリストア操作を開始することもできます。この場所から開始すると、ソース作業環境の選択には、現在の作業環境の名前が自動的に入力されます。

image:screenshot_restore_services_actions.png["サービスパネルからボリュームとファイルのリストア操作を選択する方法を示すスクリーンショット。"]



== バックアップファイルからのボリュームのリストア

バックアップファイルからボリュームをリストアすると、 Cloud Manager はバックアップのデータを使用して _new_volume を作成します。データは、同じ作業環境内のボリューム、またはソース作業環境と同じクラウドアカウントにある別の作業環境にリストアできます。オンプレミスの ONTAP システムにファイルをリストアすることもできます。

リストアするボリュームの名前と、新規にリストアされたボリュームの作成に使用するバックアップファイルの日付を把握しておく必要があります。

.手順
. [ バックアップと復元 *] タブを選択します。
. [* Restore * （復元） ] タブをクリックすると、 [Restore Dashboard （復元ダッシュボード） ] が表示されます。
. ［ * リストアボリューム * ］ をクリックします。
+
image:screenshot_restore_volume_selection.png["Restore Dashboard から Restore Volumes （ボリュームの復元）ボタンを選択するスクリーンショット。"]

. [ ソースの選択 ] ページで ' リストアするボリュームのバックアップ・ファイル（スナップショット）に移動しますリストアする日付とタイムスタンプの * Working Environment * 、 * Volume * 、および * Snapshot * を選択します。
+
image:screenshot_restore_select_volume_snapshot.png["リストアする作業環境、ボリューム、およびボリューム Snapshot を選択するスクリーンショット。"]

. [* Continue （続行） ] をクリックします
. [ リストア先の選択 ] ページで、ボリュームをリストアする * 作業環境 * を選択します。
+
image:screenshot_restore_select_work_env_volume.png["リストアするボリュームのデスティネーション作業環境の選択のスクリーンショット。"]

. オンプレミスの ONTAP システムを選択し、オブジェクトストレージへのクラスタ接続をまだ設定していない場合は、追加情報を入力するように求められます。
+
** Amazon S3 からリストアする場合、オブジェクトストレージ、バックアップが格納されているリージョン、およびデスティネーションボリュームが配置されている ONTAP クラスタ内の IPspace にアクセスするには、 AWS アカウントとアクセスキーとシークレットキーを選択します。
** Azure Blob からリストアする場合は、 Azure サブスクリプションを選択してオブジェクトストレージ、バックアップが格納されるリージョン、デスティネーションボリュームが配置されている ONTAP クラスタ内の IPspace にアクセスします。
** Google Cloud Storage からリストアする場合は、オブジェクトストレージ、バックアップが格納されているリージョン、およびデスティネーションボリュームが配置されている ONTAP クラスタ内の IPspace にアクセスするために、 Google Cloud Project と Access Key and Secret Key を選択します。
** StorageGRID からリストアする場合は、オブジェクトストレージへのアクセスに必要なアクセスキーとシークレットキー、およびデスティネーションボリュームが配置されている ONTAP クラスタ内の IPspace を選択します。


. ボリュームを配置する Storage VM を選択し、リストアするボリュームに使用する名前を入力します。デフォルトでは、 * <source_volume_name> _ Restore * がボリューム名として使用されます。
+
image:screenshot_restore_new_vol_name.png["リストアするファイルのボリュームとフォルダを選択するスクリーンショット。"]

+
ボリュームの容量に使用するアグリゲートは、オンプレミスの ONTAP システムにボリュームをリストアする場合にのみ選択できます。

. リストアの進行状況を確認できるように、 * リストア * をクリックするとリストアダッシュボードに戻ります。


Cloud Manager は、選択したバックアップに基づいて新しいボリュームを作成します。可能です link:task_managing_storage.html#managing-existing-volumes["この新しいボリュームを管理します"^] 必要に応じて。



== バックアップからのファイルのリストア

ボリュームから数個のファイルのみをリストアする必要がある場合は、ボリューム全体をリストアする代わりに、個々のファイルをリストアすることもできます。同じ作業環境内のボリューム、または同じクラウドアカウントを使用している別の作業環境にファイルをリストアできます。オンプレミスの ONTAP システムにファイルをリストアすることもできます。

選択したデスティネーションボリュームにすべてのファイルがリストアされます。ファイルを別のボリュームにリストアする場合は、リストアプロセスをもう一度実行する必要があります。



=== 前提条件

* ファイルリストア処理を実行するには、 Cloud Volumes ONTAP またはオンプレミスの ONTAP システムで ONTAP のバージョンが 9.6 以降である必要があります。
* バックアップファイルから個々のファイルをリストアする場合は、別のリストアインスタンス / 仮想マシンを使用します。を参照してください link:task_backup_to_s3.html#requirements["AWS の要件"] または link:task_backup_to_azure.html#requirements["Azure の要件"] 環境の準備状況を確認
* AWS のクロスアカウントリストアでは、クラウドプロバイダコンソールで手動の操作が必要になります。AWS のトピックを参照してください https://docs.aws.amazon.com/AmazonS3/latest/dev/example-walkthroughs-managing-access-example2.html["クロスアカウントバケットの権限を付与しています"^] を参照してください。




=== ファイルのリストアプロセス

プロセスは次のようになります。

. ボリュームから 1 つ以上のファイルを復元する場合は、 * リストア * タブをクリックし、 * ファイルの復元 * をクリックして、ファイルが存在するバックアップファイル（またはファイル）を選択します。
. Restore インスタンスが起動し、バックアップファイル内に存在するフォルダとファイルが表示されます。
+
* 注：リストアインスタンスは、ファイルを初めてリストアするときにクラウドプロバイダの環境に導入されます。

. バックアップからリストアするファイル（複数可）を選択します。
. ファイル（作業環境、ボリューム、およびフォルダ）をリストアする場所を選択し、 * リストア * をクリックします。
. ファイルがリストアされ、リストアインスタンスがシャットダウンされて、一定時間非アクティブになったあとのコストが削減されます。




=== バックアップファイルからファイルを復元しています

ボリュームバックアップからボリュームにファイルをリストアするには、次の手順を実行します。ボリュームの名前と、ファイルのリストアに使用するバックアップファイルの日付を確認しておく必要があります。この機能では、ライブブラウズを使用して、バックアップファイル内のディレクトリとファイルのリストを表示できます。

バックアップファイルは NetApp Snapshot テクノロジを使用して作成されるため、 UI の中の表現では、各バックアップファイルに「 snapshot 」が呼び出されます。

次のビデオでは、 1 つのファイルをリストアする手順を簡単に紹介します。

video::ROAY6gPL9N0[youtube, width=848,height=480]
.手順
. [ バックアップと復元 *] タブを選択します。
. [* Restore * （復元） ] タブをクリックすると、 [Restore Dashboard （復元ダッシュボード） ] が表示されます。
. [ ファイルの復元 *] ボタンをクリックします。
+
image:screenshot_restore_files_selection.png["Restore Dashboard から Restore Volumes （ボリュームの復元）ボタンを選択するスクリーンショット。"]

. [ ソースの選択 ] ページで ' リストアするファイルを含むボリュームのバックアップ・ファイル（スナップショット）に移動しますファイルのリストア元の日付とタイムスタンプが指定された * Working Environment * 、 * Volume * 、および * Snapshot * を選択します。
+
image:screenshot_restore_select_source.png["リストアするファイルのボリュームと Snapshot を選択するスクリーンショット。"]

. [* Continue （続行） ] をクリックすると、リストアインスタンスが開始されます。数分後、リストアインスタンスによってボリューム Snapshot のフォルダとファイルのリストが表示されます。
+
* 注：リストアインスタンスは、ファイルを初めてリストアするときにクラウドプロバイダの環境に導入されるため、初回のリストアには数分かかることがあります。

+
image:screenshot_restore_select_files.png["リストアするファイルに移動できるように、ファイルの選択ページのスクリーンショット。"]

. _ ファイルの選択 _ ページで、復元するファイルを選択し、 * 続行 * をクリックします。
+
** 検索アイコンをクリックしてファイル名を入力すると、そのファイルに直接移動できます。
** ファイル名が表示されている場合は、そのファイル名をクリックします。
** を使用して、フォルダ内の下位レベルに移動できます image:button_subfolder.png[""] ボタンをクリックして、ファイルを検索します。
+
ファイルを選択すると、ページの左側に追加され、選択済みのファイルが表示されます。必要に応じて、ファイル名の横にある * x * をクリックすると、このリストからファイルを削除できます。



. 保存先の選択ページで、ファイルを復元する * 作業環境 * を選択します。
+
image:screenshot_restore_select_work_env.png["リストアするファイルのデスティネーション作業環境の選択のスクリーンショット。"]

+
オンプレミスクラスタを選択し、オブジェクトストレージへのクラスタ接続をまだ設定していない場合は、追加情報を入力するように求められます。

+
** Amazon S3 からリストアする場合は、デスティネーションボリュームが配置されている ONTAP クラスタの IPspace と、オブジェクトストレージへのアクセスに必要な AWS Access Key および Secret Key を入力します。
** Azure Blob からリストアする場合は、デスティネーションボリュームが配置されている ONTAP クラスタ内の IPspace を入力します。


. 次に、ファイルを復元する * Volume * と * Folder * を選択します。
+
image:screenshot_restore_select_dest.png["リストアするファイルのボリュームとフォルダを選択するスクリーンショット。"]

+
ファイルを復元する場合は、いくつかのオプションがあります。

+
** 上の図のように、 [ ターゲットフォルダの選択 ] を選択した場合は、次のようになります。
+
*** 任意のフォルダを選択できます。
*** フォルダにカーソルを合わせて、をクリックできます image:button_subfolder.png[""] 行の末尾にあるサブフォルダをドリルダウンし、フォルダを選択します。


** ソースファイルがある場所と同じ宛先作業環境とボリュームを選択した場合は、「ソースフォルダーパスを保持」を選択して、ソース構造内に存在していた同じフォルダーにファイルまたはすべてのファイルを復元できます。同じフォルダとサブフォルダがすべて存在している必要があります。フォルダは作成されません。


. リストアの進行状況を確認できるように、 * リストア * をクリックするとリストアダッシュボードに戻ります。


リストア・インスタンスは、アクティブなときにのみコストが発生するように、一定の非アクティブ期間後にシャットダウンされます。
