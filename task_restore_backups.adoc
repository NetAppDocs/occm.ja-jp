---
sidebar: sidebar 
permalink: task_restore_backups.html 
keywords: restoring, restore, restore volumes, restore files, Backup to Cloud, cloud backup service, single file restore 
summary: バックアップは、特定の時点のデータをリストアできるように、クラウドアカウントのオブジェクトストアに格納されます。保存したバックアップファイルからボリューム全体をリストアすることも、いくつかのファイルのみをリストアする必要がある場合は、保存したバックアップファイルから最大 8 つのファイルを（一度に）リストアすることもできます。 
---
= バックアップファイルからのボリュームデータのリストア
:hardbreaks:
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./media/


[role="lead"]
バックアップは、特定の時点のデータをリストアできるように、クラウドアカウントのオブジェクトストアに格納されます。保存したバックアップファイルからボリューム全体をリストアすることも、いくつかのファイルのみをリストアする必要がある場合は、保存したバックアップファイルから最大 8 つのファイルを（一度に）リストアすることもできます。

_ ボリューム全体のリストア _ は、バックアップファイルの作成に使用した Backup to Cloud サービスの一部です。作業環境でクラウドへのバックアップサービスをアクティブ化すると、同じ作業環境または同じクラウドアカウントを使用する別の作業環境にボリューム全体をリストアできます。を参照してください <<Restoring a volume from a backup,バックアップからのボリュームのリストア>>。

_ 個々のファイルをリストアする _ バックアップファイルから実際には 2 つのサービスを使用します。Backup to Cloud サービスを使用して、前述のようにバックアップファイルを作成します。ただし、単一ファイルのリストアを開始すると、リストアサービスを使用してファイルがリストアされます。同じ作業環境内のボリューム、または同じクラウドアカウントを使用している別の作業環境のボリュームにファイルをリストアできます。オンプレミスの ONTAP システム上のボリュームにファイルをリストアすることもできます。を参照してください <<Restoring files from a backup,バックアップからのファイルのリストア>>。



== バックアップからのボリュームのリストア

バックアップファイルからボリュームをリストアすると、 Cloud Manager はバックアップのデータを使用して _new_volume を作成します。データは、同じ作業環境内のボリューム、またはソース作業環境と同じクラウドアカウントにある別の作業環境にリストアできます。



=== サポートされている作業環境

次の作業環境にバックアップファイルからボリュームをリストアできます。

[cols="30,40"]
|===
| バックアップファイルの場所 | 作業環境を復元します 


| Amazon S3 | AWS の Cloud Volumes ONTAP 


| Azure Blob の略 | Azure の Cloud Volumes ONTAP 


| Google クラウドストレージ | Google の Cloud Volumes ONTAP 
|===
.手順
. およびキャンバスで、作業環境を選択します。
. [ サービス ] パネルで、をクリックします image:screenshot_gallery_options.gif["[ 詳細 ] アイコン"] をクリックし、 * View Backups * を選択します。
+
image:screenshot_view_backups_selection.png["作業環境の View Backups ボタンを選択した場合のスクリーンショット"]

. リストアするボリュームの行を選択し、 * バックアップリストの表示 * をクリックします。
+
image:screenshot_backup_to_s3_volume.gif["バックアップと復元タブのスクリーンショット。バックアップがあるボリュームを示しています。"]

. 日付 / 時刻スタンプに基づいてリストアするバックアップを検索し、 * Restore * アイコンをクリックします。
+
image:screenshot_backup_to_s3_restore_icon.gif["ボリュームを選択したあとのバックアップのリストアアイコンのスクリーンショット。"]

. 新しい volume_page にリストアバックアップを記入します。
+
.. 作業環境を選択します。
.. ボリュームの名前を入力します。
.. [* リストア ] をクリックします。
+
image:screenshot_backup_to_s3_restore_options.gif["リストア先のオプションである作業環境、ボリューム、およびボリューム情報を示すスクリーンショット。"]





Cloud Manager では、選択したバックアップに基づいて新しいボリュームが作成され、その作業環境が表示されます。これにより、リストアの進捗状況を確認できます。可能です link:task_managing_storage.html#managing-existing-volumes["この新しいボリュームを管理します"^] 必要に応じて。



== バックアップからのファイルのリストア

ボリュームから数個のファイルのみをリストアする必要がある場合は、ボリューム全体をリストアする代わりに、個々のファイルをリストアすることもできます。バックアップファイルから個々のファイルをリストアするには、 Restore サービスを使用します。同じ作業環境内のボリューム、または同じクラウドアカウントを使用している別の作業環境にファイルをリストアできます。オンプレミスの ONTAP システムにファイルをリストアすることもできます。

バックアップファイル内のボリュームから一度に最大 8 個のファイルをリストアできます。8 個以上のファイルをリストアする必要がある場合は、リストアプロセスをもう一度実行できます。選択したデスティネーションボリュームにすべてのファイルがリストアされます。



=== サポートされている作業環境

バックアップファイルから個々のファイルを次の作業環境にリストアできます。

[cols="30,40"]
|===
| バックアップファイルの場所 | 作業環境を復元します 


| Amazon S3 | オンプレミスの AWS ONTAP システムに Cloud Volumes ONTAP が導入されている 


| Azure Blob の略 | オンプレミスの Azure ONTAP システムに Cloud Volumes ONTAP を導入 
|===


=== 単一ファイルのリストアプロセス

プロセスは次のようになります。

. [ サービス ] パネルから [ リストア ] サービスを有効にすると、 [ リストア ] タブの [ リストア ] ページに移動します。
. ボリュームから 1 つ以上のファイルをリストアする場合は、 Restore （復元）タブを選択し、ファイルが存在するバックアップファイル（スナップショット）を選択します。
+
Restore インスタンスが起動し、バックアップファイル内に存在するフォルダとファイルが表示されます。

+
リストアインスタンスは、ファイルを初めてリストアしたときにクラウドプロバイダの環境に導入されます。

. バックアップからファイル（または最大 8 ファイル）を選択し、ファイルを書き込む場所（作業環境、ボリューム、およびフォルダ）を選択して、 [ 復元 ] をクリックします。
+
Restore インスタンスはファイルをリストアし、次にインスタンスをシャットダウンして、一定時間非アクティブにしたあとのコストを節約します。





=== 詳細

を参照してください link:concept_backup_to_cloud.html#cost["このトピック"^] Backup to Cloud サービスと Restore サービスの両方のコストを負担します。

.インスタンスタイプ
* AWS では、 Restore インスタンスはで実行されます https://aws.amazon.com/ec2/instance-types/m5/["m5n.xlarge インスタンス"^] CPU × 4 、 16GiB メモリ、 EBS のみのインスタンスストレージ。m5n.xlarge インスタンスを使用できない領域では、代わりに m5.xlarge インスタンスで Restore が実行されます。
* Azure では、 Restore 仮想マシンがで実行されます https://docs.microsoft.com/en-us/azure/virtual-machines/dv3-dsv3-series#dsv3-series["Standard_D4s_v3 VM"^] CPU × 4 、 16GiB メモリ、 32GB ディスク × 1


AWS でリストアサービスを使用する場合、 Cloud Manager に権限を提供する IAM ロールに最新のからの S3 権限を含める必要があります https://mysupport.netapp.com/site/info/cloud-manager-policies["Cloud Manager ポリシー"^] を参照してください link:task_backup_to_s3.html#requirements["AWS の要件"^]。

また、単一ファイルのリストアのポリシーでは、次の権限が必要です。

[source, json]
----
  "Action": [
    "ec2:DescribeInstanceTypeOfferings",
    "ec2:startInstances",
    "ec2:stopInstances",
    "ec2:terminateInstances"
  ],
----
Restore インスタンスでは、パブリッククラウド環境内のリソースとプロセスを管理するためにアウトバウンドのインターネットアクセスが必要になります。



=== Restore サービスを有効にしています

これは、作業環境ごとの 1 回限りの処理です。


NOTE: この作業環境では、クラウドへのバックアップサービスがすでにアクティブ化されている必要があります。

.手順
. およびキャンバスで、作業環境を選択します。
. Restore サービスの *Enable* ボタンをクリックします。
+
image:screenshot_restore_activate_button.png["単一ファイルのリストア機能を有効にするための有効化ボタンのスクリーンショット。"]



[ リストア ] タブの [ リストア ] ページが表示されます。



=== バックアップファイルからの単一ファイルのリストア

ボリュームバックアップからボリュームに最大 8 つのファイルをリストアする手順は、次のとおりです。ファイルのリストアに使用するバックアップファイルの日付を把握しておく必要があります。この機能では、ライブブラウズを使用して、バックアップファイル内の現在のディレクトリとファイルのリストを表示できます。

バックアップファイルは NetApp Snapshot テクノロジを使用して作成されるため、 UI の中の表現では、各バックアップファイルに「 snapshot 」が呼び出されます。

次のビデオでは、 1 つのファイルをリストアする手順を簡単に紹介します。

video::ROAY6gPL9N0[youtube, width=848,height=480]

NOTE: ソースおよびデスティネーションの ONTAP システムで ONTAP のバージョンが 9.6 以降である必要があります。

.手順
. [* リストア *] タブをクリックします。
+
リストアダッシュボードが表示されます。

+
image:screenshot_restore_inventory_page.png["完了したすべてのリストア処理を示すリストアインベントリページのスクリーンショット。[ ファイルの復元 ] ボタンも表示されます。"]

. [ ファイルの復元 *] ボタンをクリックします。
. [ ソースの選択 ] ページで、ファイルのリストア元の日付 / 時刻スタンプを持つ * 作業環境 * 、 * ボリューム * 、および * スナップショット * を選択します。
+
image:screenshot_restore_select_source.png["リストアするファイルのボリュームと Snapshot を選択するスクリーンショット。"]

. [* Continue （続行） ] をクリックすると、リストアインスタンスが開始されます。数分後、リストアインスタンスによってボリューム Snapshot のフォルダとファイルのリストが表示されます。
+
リストアインスタンスは、ファイルの初回リストア時にクラウドプロバイダの環境に導入されます。この処理には、最初のリストアから数分かかることがあります。

+
image:screenshot_restore_select_files.png["リストアするファイルに移動できるように、ファイルの選択ページのスクリーンショット。"]

. _ ファイルの選択 _ ページで、復元するファイルを選択し、 * 続行 * をクリックします。
+
** 検索アイコンをクリックしてファイル名を入力すると、そのファイルに直接移動できます。
** ファイル名が表示されている場合は、そのファイル名をクリックします。
** を使用して、フォルダ内の下位レベルに移動できます image:button_subfolder.png[""] ボタンをクリックして、ファイルを検索します。
+
ファイルを選択すると、ページの左側に追加され、選択済みのファイルが表示されます。必要に応じて、ファイル名の横にある * x * をクリックすると、このリストからファイルを削除できます。



. [ 保存先の選択 ] ページで、 * 作業環境 * を選択します。
+
image:screenshot_restore_select_work_env.png["リストアするファイルのデスティネーション作業環境の選択のスクリーンショット。"]

+
オンプレミスクラスタを選択し、オブジェクトストレージへのクラスタ接続をまだ設定していない場合は、追加情報を入力するように求められます。

+
** Amazon S3 からリストアする場合は、デスティネーションボリュームが配置されている ONTAP クラスタに IPspace と入力し、バックアップファイルにアクセスするために AWS Access Key and Secret Key を指定します。
** Azure Blob からリストアする場合は、デスティネーションボリュームが配置されている ONTAP クラスタ内の IPspace を入力します。


. 次に、ファイルを復元する * Volume * と * Folder * を選択します。
+
image:screenshot_restore_select_dest.png["リストアするファイルのボリュームとフォルダを選択するスクリーンショット。"]

+
ファイルを復元する場合は、いくつかのオプションがあります。

+
** 上の図のように、 [ ターゲットフォルダの選択 ] を選択した場合は、次のようになります。
+
*** 任意のフォルダを選択できます。
*** フォルダにカーソルを合わせて、をクリックできます image:button_subfolder.png[""] 行の末尾にあるサブフォルダをドリルダウンし、フォルダを選択します。


** 同じ作業環境とボリュームを選択した場合 をソースファイルとして指定します image:button_source.png[""] アイコン）をクリックすると、「ソースフォルダーパスを保持」を選択して、ソース構造内に存在していたのと同じフォルダーにファイルまたはすべてのファイルを復元できます。同じフォルダとサブフォルダがすべて存在している必要があります。フォルダは作成されません。


. リストア処理の進捗状況を確認できるように、 * リストア * をクリックするとリストアダッシュボードに戻ります。


Restore インスタンスは、一定の非アクティブ期間が経過するとシャットダウンされるため、コストが節約され、 Restore インスタンスがアクティブなときにのみコストが発生します。
